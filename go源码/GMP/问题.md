1. 什么是内核级线程，什么是用户级线程？

   ##### 用户级线程

   定义：对于操作系统来说，他看见的只有进程，因此我们所用的pthread_creat等管理线程的函数，属于用户取管理调度，这就是用户级线程。

   缺点：

   - 操作系统眼中还是单线程程序，因此如果有一个线程阻塞住了，那么其他线程都将无法执行。所以在执行阻塞操作时，比如io操作，会先检查io操作是否正忙，如果忙则执行其他线程

   - 本质是单线程程序，无法利用多核进行并行

   优点：

   - 线程的切换、创建、销毁都需要进行系统，耗费时间
   - 相比于用户级线程数量更加有限

   内核级线程：随着时间的推移大家渐渐也接受了线程这个概念，进而修改了内核代码，现在操作系统就能看到线程了，他维护了一张线程表，

   系统调用：故名思义就是通过操作系统调用，因为用户的权限不能太大，就行root用户，你可以请求他帮你做一些高权限的事情，但是这事能不能做由他决定

2. 线程阻塞是什么意思？会阻塞住操作系统，不让其他线程执行吗？

   阻塞就是线程需要进行io操作，此时释放cpu资源，等待io操作完成再到cpu上运算

3. 什么是GMP，GMP有什么用？

   GMP是Go协程的调度模型，增加并发的效率

4. M的扩容机制是什么？当创建了大量的G，P和G会怎样扩容？

   M不够用就会扩，G执行时阻塞，P无G执行。P无法增加，程序运行时就创建好了

5. P中无可用的G时到哪获取G？

   先用负载均衡策略在全局队列中取，当全局队列中没有时再到其他P中窃取

6. 在全局取G时取多少个G？

   ```go
   n = min(len(GQ)/GOMAXPROCS + 1, len(GQ/2))
   ```

   负载均衡

7. 信号抢占式调度是什么？

8. GMP发展史？

9. 所有的调用都要切换到内核线程才能被调度吗？

   对于有线程的内核是这样的，内核中有线程的存储和调度方式，因此用户级线程必须通过系统调用切换到内核中才能被调度

10. 无栈协程和有栈协程区别？

11. 代码

    ![preview](../../v2-85359486219d4ce31b93fa450b592083_r.jpg)

